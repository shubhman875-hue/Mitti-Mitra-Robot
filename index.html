<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mitti Mitra Robot</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(180deg, #1a1f3a 0%, #2d3561 50%, #1e243e 100%);
            min-height: 100vh;
            color: #c9d1d9;
            padding: 15px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .glass {
            background: rgba(30, 36, 62, 0.6);
            backdrop-filter: blur(40px);
            -webkit-backdrop-filter: blur(40px);
            border: 1px solid rgba(255, 255, 255, 0.06);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5);
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
            position: relative;
            padding-top: 10px;
        }

        .header h1 {
            font-size: 26px;
            margin-bottom: 6px;
            color: #ffffff;
            font-weight: 600;
        }

        .subtitle {
            color: rgba(201, 209, 217, 0.6);
            font-size: 14px;
        }

        .language-selector {
            position: absolute;
            top: 0;
            right: 0;
            background: rgba(30, 36, 62, 0.7);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            padding: 8px 15px;
            border-radius: 20px;
            color: #c9d1d9;
            font-size: 13px;
            cursor: pointer;
        }

        .status-bar {
            padding: 14px 18px;
            border-radius: 15px;
            margin-bottom: 18px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4ade80;
            box-shadow: 0 0 12px #4ade80;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .section-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 12px;
            color: #ffffff;
        }

        .region-selector-container {
            margin-bottom: 12px;
        }

        .region-selector {
            width: 100%;
            padding: 12px 16px;
            border-radius: 14px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            background: rgba(30, 36, 62, 0.7);
            backdrop-filter: blur(20px);
            color: #c9d1d9;
            font-size: 14px;
            cursor: pointer;
        }

        .region-selector option {
            background: #2d3561;
            color: #ffffff;
        }

        .weather-scroll-container {
            margin-bottom: 20px;
        }

        .weather-scroll {
            display: flex;
            gap: 12px;
            overflow-x: auto;
            padding-bottom: 12px;
            scroll-behavior: smooth;
        }

        .weather-scroll::-webkit-scrollbar {
            height: 4px;
        }

        .weather-scroll::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
        }

        .weather-scroll::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 10px;
        }

        .weather-card {
            min-width: 170px;
            padding: 18px;
            border-radius: 14px;
            text-align: center;
            flex-shrink: 0;
        }

        .weather-city {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #ffffff;
        }

        .weather-temp {
            font-size: 38px;
            font-weight: bold;
            color: #4ade80;
            margin: 8px 0;
        }

        .weather-condition {
            font-size: 13px;
            color: rgba(201, 209, 217, 0.6);
            margin-bottom: 10px;
        }

        .weather-details {
            display: flex;
            justify-content: space-around;
            padding-top: 10px;
            border-top: 1px solid rgba(255, 255, 255, 0.06);
            font-size: 12px;
            color: rgba(201, 209, 217, 0.6);
        }

        .sensor-section {
            margin-bottom: 20px;
        }

        .sensor-card {
            padding: 20px;
            border-radius: 14px;
            margin-bottom: 12px;
        }

        .sensor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .sensor-name {
            font-size: 14px;
            color: rgba(201, 209, 217, 0.7);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .sensor-badge {
            padding: 5px 12px;
            border-radius: 14px;
            font-size: 11px;
            font-weight: 600;
        }

        .badge-optimal {
            background: rgba(74, 222, 128, 0.15);
            color: #4ade80;
            border: 1px solid rgba(74, 222, 128, 0.3);
        }

        .badge-warning {
            background: rgba(251, 146, 60, 0.15);
            color: #fb923c;
            border: 1px solid rgba(251, 146, 60, 0.3);
        }

        .badge-critical {
            background: rgba(239, 68, 68, 0.15);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .sensor-value {
            font-size: 42px;
            font-weight: bold;
            color: #ffffff;
            margin: 10px 0;
        }

        .sensor-range {
            font-size: 12px;
            color: rgba(201, 209, 217, 0.5);
            margin-bottom: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 5px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .progress-optimal { background: linear-gradient(90deg, #4ade80, #22d3ee); }
        .progress-warning { background: linear-gradient(90deg, #fb923c, #f59e0b); }
        .progress-critical { background: linear-gradient(90deg, #ef4444, #dc2626); }

        .recommendations-section {
            margin-bottom: 20px;
        }

        .recommendation-card {
            padding: 16px;
            border-radius: 14px;
            margin-bottom: 10px;
        }

        .recommendation-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #ffffff;
        }

        .recommendation-action {
            font-size: 13px;
            color: rgba(201, 209, 217, 0.6);
            margin-left: 16px;
            display: block;
            margin-top: 5px;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 18px;
        }

        .btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 14px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4ade80 0%, #22d3ee 100%);
            color: #1a1f3a;
        }

        .btn-secondary {
            background: rgba(30, 36, 62, 0.7);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            color: #c9d1d9;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: rgba(201, 209, 217, 0.5);
            font-size: 13px;
        }

        @media (max-width: 600px) {
            .language-selector {
                position: static;
                margin: 0 auto 15px;
                display: block;
                width: fit-content;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <select class="language-selector" id="langSelect">
                <option value="en">English</option>
                <option value="hi">‡§π‡§ø‡§Ç‡§¶‡•Ä</option>
                <option value="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</option>
                <option value="te">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</option>
                <option value="mr">‡§Æ‡§∞‡§æ‡§†‡•Ä</option>
                <option value="kn">‡≤ï‡≤®‡≥ç‡≤®‡≤°</option>
                <option value="bn">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</option>
                <option value="gu">‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä</option>
                <option value="pa">‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä</option>
                <option value="ml">‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç</option>
                <option value="or">‡¨ì‡¨°‡¨º‡¨ø‡¨Ü</option>
            </select>
            <h1 id="title">Mitti Mitra Robot</h1>
            <p class="subtitle" id="sub">Smart Farming Assistant</p>
        </div>

        <div class="status-bar glass">
            <div class="status-indicator">
                <div class="status-dot"></div>
                <span id="status">Connected</span>
            </div>
            <div style="font-size: 12px;" id="time">2 min ago</div>
        </div>

        <div class="weather-scroll-container">
            <h3 class="section-title" id="wtitle">üå¶Ô∏è Weather Forecast</h3>
            
            <div class="region-selector-container">
                <select class="region-selector glass" id="regionSelect">
                    <optgroup label="Chandigarh Tricity">
                        <option value="Panchkula,IN">Panchkula, Haryana</option>
                        <option value="Chandigarh,IN" selected>Chandigarh</option>
                        <option value="Mohali,IN">Mohali, Punjab</option>
                    </optgroup>
                    <optgroup label="Haryana">
                        <option value="Gurugram,IN">Gurugram</option>
                        <option value="Faridabad,IN">Faridabad</option>
                        <option value="Ambala,IN">Ambala</option>
                        <option value="Karnal,IN">Karnal</option>
                        <option value="Panipat,IN">Panipat</option>
                    </optgroup>
                    <optgroup label="Punjab">
                        <option value="Ludhiana,IN">Ludhiana</option>
                        <option value="Amritsar,IN">Amritsar</option>
                        <option value="Jalandhar,IN">Jalandhar</option>
                        <option value="Patiala,IN">Patiala</option>
                    </optgroup>
                    <optgroup label="Delhi NCR">
                        <option value="Delhi,IN">Delhi</option>
                        <option value="Noida,IN">Noida</option>
                        <option value="Ghaziabad,IN">Ghaziabad</option>
                    </optgroup>
                    <optgroup label="Major Cities">
                        <option value="Mumbai,IN">Mumbai</option>
                        <option value="Bangalore,IN">Bangalore</option>
                        <option value="Chennai,IN">Chennai</option>
                        <option value="Kolkata,IN">Kolkata</option>
                        <option value="Hyderabad,IN">Hyderabad</option>
                        <option value="Pune,IN">Pune</option>
                        <option value="Ahmedabad,IN">Ahmedabad</option>
                        <option value="Jaipur,IN">Jaipur</option>
                    </optgroup>
                </select>
            </div>
            
            <div class="weather-scroll" id="weatherBox">
                <div class="loading">Loading weather...</div>
            </div>
        </div>

        <div class="sensor-section">
            <h3 class="section-title" id="stitle">üìä Sensor Readings</h3>
            
            <div class="sensor-card glass">
                <div class="sensor-header">
                    <div class="sensor-name"><span>üå°Ô∏è</span> <span id="ph">pH Level</span></div>
                    <span class="sensor-badge badge-optimal"><span id="opt">Optimal</span></span>
                </div>
                <div class="sensor-value">6.5</div>
                <div class="sensor-range"><span id="r1">Range:</span> 6.0-7.5</div>
                <div class="progress-bar">
                    <div class="progress-fill progress-optimal" style="width: 87%;"></div>
                </div>
            </div>

            <div class="sensor-card glass">
                <div class="sensor-header">
                    <div class="sensor-name"><span>üíß</span> <span id="moist">Moisture</span></div>
                    <span class="sensor-badge badge-warning"><span id="low">Low</span></span>
                </div>
                <div class="sensor-value">45%</div>
                <div class="sensor-range"><span id="r2">Range:</span> 60-80% optimal</div>
                <div class="progress-bar">
                    <div class="progress-fill progress-warning" style="width: 45%;"></div>
                </div>
            </div>

            <div class="sensor-card glass">
                <div class="sensor-header">
                    <div class="sensor-name"><span>üå±</span> <span id="nitro">Nitrogen</span></div>
                    <span class="sensor-badge badge-critical"><span id="crit">Critical</span></span>
                </div>
                <div class="sensor-value" id="lval">Low</div>
                <div class="sensor-range">Green Index: 95/255</div>
                <div class="progress-bar">
                    <div class="progress-fill progress-critical" style="width: 30%;"></div>
                </div>
            </div>
        </div>

        <div class="recommendations-section">
            <h3 class="section-title" id="rtitle">üí° Recommendations</h3>
            
            <div class="recommendation-card glass">
                <div class="recommendation-title" id="rec1">‚ö†Ô∏è Soil is dry</div>
                <span class="recommendation-action" id="rec1a">‚Üí Water immediately</span>
                <span class="recommendation-action" id="rec1b">‚Üí Apply mulch layer</span>
            </div>

            <div class="recommendation-card glass">
                <div class="recommendation-title" id="rec2">üî¥ Nitrogen deficiency</div>
                <span class="recommendation-action" id="rec2a">‚Üí Add Neem Cake: 50g/plant</span>
                <span class="recommendation-action" id="rec2b">‚Üí Or Vermicompost: 200g</span>
            </div>

            <div class="recommendation-card glass">
                <div class="recommendation-title" id="rec3">‚úÖ pH is optimal</div>
                <span class="recommendation-action" id="rec3a">‚Üí No action needed</span>
            </div>
        </div>

        <div class="button-group">
            <button class="btn btn-primary" onclick="refresh()">
                üîÑ <span id="rbtn">Refresh</span>
            </button>
            <button class="btn btn-secondary" onclick="showHistory()">
                üìä <span id="hbtn">History</span>
            </button>
        </div>
    </div>

    <script>
        const KEY = '3045dd712ffe6e702e3245525ac7fa38';
        
        const lang = {
            en: {title:'Mitti Mitra Robot',sub:'Smart Farming Assistant',status:'Connected',wtitle:'üå¶Ô∏è Weather Forecast',stitle:'üìä Sensor Readings',rtitle:'üí° Recommendations',ph:'pH Level',moist:'Moisture',nitro:'Nitrogen',opt:'Optimal',low:'Low',crit:'Critical',lval:'Low',r1:'Range:',r2:'Range:',rbtn:'Refresh',hbtn:'History',rec1:'‚ö†Ô∏è Soil is dry',rec1a:'‚Üí Water immediately',rec1b:'‚Üí Apply mulch layer',rec2:'üî¥ Nitrogen deficiency',rec2a:'‚Üí Add Neem Cake: 50g/plant',rec2b:'‚Üí Or Vermicompost: 200g',rec3:'‚úÖ pH is optimal',rec3a:'‚Üí No action needed'},
            hi: {title:'‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§Æ‡§ø‡§§‡•ç‡§∞ ‡§∞‡•ã‡§¨‡•ã‡§ü',sub:'‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§ñ‡•á‡§§‡•Ä ‡§∏‡§π‡§æ‡§Ø‡§ï',status:'‡§ú‡•Å‡§°‡§º‡§æ',wtitle:'üå¶Ô∏è ‡§Æ‡•å‡§∏‡§Æ',stitle:'üìä ‡§∏‡•á‡§Ç‡§∏‡§∞',rtitle:'üí° ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂‡•á‡§Ç',ph:'‡§™‡•Ä‡§è‡§ö',moist:'‡§®‡§Æ‡•Ä',nitro:'‡§®‡§æ‡§á‡§ü‡•ç‡§∞‡•ã‡§ú‡§®',opt:'‡§¨‡§¢‡§º‡§ø‡§Ø‡§æ',low:'‡§ï‡§Æ',crit:'‡§ó‡§Ç‡§≠‡•Ä‡§∞',lval:'‡§ï‡§Æ',r1:'‡§∏‡•Ä‡§Æ‡§æ:',r2:'‡§∏‡•Ä‡§Æ‡§æ:',rbtn:'‡§∞‡•Ä‡§´‡•ç‡§∞‡•á‡§∂',hbtn:'‡§á‡§§‡§ø‡§π‡§æ‡§∏',rec1:'‚ö†Ô∏è ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§∏‡•Ç‡§ñ‡•Ä',rec1a:'‚Üí ‡§§‡•Å‡§∞‡§Ç‡§§ ‡§™‡§æ‡§®‡•Ä ‡§¶‡•á‡§Ç',rec1b:'‚Üí ‡§ó‡•Ä‡§≤‡•Ä ‡§ò‡§æ‡§∏ ‡§≤‡§ó‡§æ‡§è‡§Ç',rec2:'üî¥ ‡§®‡§æ‡§á‡§ü‡•ç‡§∞‡•ã‡§ú‡§® ‡§ï‡§Æ‡•Ä',rec2a:'‚Üí ‡§®‡•Ä‡§Æ ‡§ñ‡§≤‡•Ä ‡§°‡§æ‡§≤‡•á‡§Ç',rec2b:'‚Üí ‡§µ‡§∞‡•ç‡§Æ‡•Ä‡§ï‡§Æ‡•ç‡§™‡•ã‡§∏‡•ç‡§ü ‡§¶‡•á‡§Ç',rec3:'‚úÖ ‡§™‡•Ä‡§è‡§ö ‡§†‡•Ä‡§ï ‡§π‡•à',rec3a:'‚Üí ‡§ï‡•Å‡§õ ‡§®‡§π‡•Ä‡§Ç'},
            ta: {title:'‡ÆÆ‡Æø‡Æü‡Øç‡Æü‡Æø ‡ÆÆ‡Æø‡Æ§‡Øç‡Æ∞‡Ææ',sub:'‡Æµ‡Æø‡Æµ‡Æö‡Ææ‡ÆØ ‡Æâ‡Æ§‡Æµ‡Æø',status:'‡Æá‡Æ£‡Øà‡Æ™‡Øç‡Æ™‡ØÅ',wtitle:'üå¶Ô∏è ‡Æµ‡Ææ‡Æ©‡Æø‡Æ≤‡Øà',stitle:'üìä ‡Æö‡ØÜ‡Æ©‡Øç‡Æö‡Ææ‡Æ∞‡Øç',rtitle:'üí° ‡Æ™‡Æ∞‡Æø‡Æ®‡Øç‡Æ§‡ØÅ‡Æ∞‡Øà',ph:'pH',moist:'‡Æà‡Æ∞‡ÆÆ‡Øç',nitro:'‡Æ®‡Øà‡Æü‡Øç‡Æ∞‡Æú‡Æ©‡Øç',opt:'‡Æ®‡Æ≤‡Øç‡Æ≤‡Æ§‡ØÅ',low:'‡Æï‡ØÅ‡Æ±‡Øà‡Æµ‡ØÅ',crit:'‡ÆÖ‡Æµ‡Æö‡Æ∞‡ÆÆ‡Øç',lval:'‡Æï‡ØÅ‡Æ±‡Øà‡Æµ‡ØÅ',r1:'‡Æµ‡Æ∞‡ÆÆ‡Øç‡Æ™‡ØÅ:',r2:'‡Æµ‡Æ∞‡ÆÆ‡Øç‡Æ™‡ØÅ:',rbtn:'‡Æ™‡ØÅ‡Æ§‡ØÅ‡Æ™‡Øç‡Æ™‡Æø',hbtn:'‡Æµ‡Æ∞‡Æ≤‡Ææ‡Æ±‡ØÅ'},
            te: {title:'‡∞Æ‡∞ø‡∞ü‡±ç‡∞ü‡∞ø ‡∞Æ‡∞ø‡∞§‡±ç‡∞∞',sub:'‡∞µ‡±ç‡∞Ø‡∞µ‡∞∏‡∞æ‡∞Ø‡∞Ç',status:'‡∞ï‡∞®‡±Ü‡∞ï‡±ç‡∞ü‡±ç',wtitle:'üå¶Ô∏è ‡∞µ‡∞æ‡∞§‡∞æ‡∞µ‡∞∞‡∞£‡∞Ç',stitle:'üìä ‡∞∏‡±Ü‡∞®‡±ç‡∞∏‡∞æ‡∞∞‡±ç',rtitle:'üí° ‡∞∏‡±Ç‡∞ö‡∞®‡∞≤‡±Å',ph:'pH',moist:'‡∞§‡±á‡∞Æ',nitro:'‡∞®‡±à‡∞ü‡±ç‡∞∞‡±ã‡∞ú‡∞®‡±ç',opt:'‡∞Æ‡∞Ç‡∞ö‡∞ø',low:'‡∞§‡∞ï‡±ç‡∞ï‡±Å‡∞µ',crit:'‡∞§‡±Ä‡∞µ‡±ç‡∞∞‡∞Ç',lval:'‡∞§‡∞ï‡±ç‡∞ï‡±Å‡∞µ',r1:'‡∞™‡∞∞‡∞ø‡∞ß‡∞ø:',r2:'‡∞™‡∞∞‡∞ø‡∞ß‡∞ø:',rbtn:'‡∞∞‡∞ø‡∞´‡±ç‡∞∞‡±Ü‡∞∑‡±ç',hbtn:'‡∞ö‡∞∞‡∞ø‡∞§‡±ç‡∞∞'},
            mr: {title:'‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§Æ‡§ø‡§§‡•ç‡§∞',sub:'‡§∂‡•á‡§§‡•Ä ‡§Æ‡§¶‡§§',status:'‡§ú‡•ã‡§°‡§≤‡•á',wtitle:'üå¶Ô∏è ‡§π‡§µ‡§æ‡§Æ‡§æ‡§®',stitle:'üìä ‡§∏‡•á‡§®‡•ç‡§∏‡§∞',rtitle:'üí° ‡§∏‡•Ç‡§ö‡§®‡§æ',ph:'pH',moist:'‡§ì‡§≤‡§æ‡§µ‡§æ',nitro:'‡§®‡§æ‡§Ø‡§ü‡•ç‡§∞‡•ã‡§ú‡§®',opt:'‡§ö‡§æ‡§Ç‡§ó‡§≤‡•á',low:'‡§ï‡§Æ‡•Ä',crit:'‡§ó‡§Ç‡§≠‡•Ä‡§∞',lval:'‡§ï‡§Æ‡•Ä',r1:'‡§∂‡•ç‡§∞‡•á‡§£‡•Ä:',r2:'‡§∂‡•ç‡§∞‡•á‡§£‡•Ä:',rbtn:'‡§∞‡•Ä‡§´‡•ç‡§∞‡•á‡§∂',hbtn:'‡§á‡§§‡§ø‡§π‡§æ‡§∏'},
            kn: {title:'‡≤Æ‡≤ø‡≤ü‡≥ç‡≤ü‡≤ø ‡≤Æ‡≤ø‡≤§‡≥ç‡≤∞',sub:'‡≤ï‡≥É‡≤∑‡≤ø',status:'‡≤∏‡≤Ç‡≤™‡≤∞‡≥ç‡≤ï',wtitle:'üå¶Ô∏è ‡≤π‡≤µ‡≤æ‡≤Æ‡≤æ‡≤®',stitle:'üìä ‡≤∏‡≥Ü‡≤®‡≥ç‡≤∏‡≤æ‡≤∞‡≥ç',rtitle:'üí° ‡≤∏‡≥Ç‡≤ö‡≤®‡≥Ü',ph:'pH',moist:'‡≤§‡≥á‡≤µ‡≤æ‡≤Ç‡≤∂',nitro:'‡≤®‡≥à‡≤ü‡≥ç‡≤∞‡≥ã‡≤ú‡≤®‡≥ç',opt:'‡≤â‡≤§‡≥ç‡≤§‡≤Æ',low:'‡≤ï‡≤°‡≤ø‡≤Æ‡≥Ü',crit:'‡≤§‡≥Ä‡≤µ‡≥ç‡≤∞',lval:'‡≤ï‡≤°‡≤ø‡≤Æ‡≥Ü',r1:'‡≤µ‡≥ç‡≤Ø‡≤æ‡≤™‡≥ç‡≤§‡≤ø:',r2:'‡≤µ‡≥ç‡≤Ø‡≤æ‡≤™‡≥ç‡≤§‡≤ø:',rbtn:'‡≤∞‡≤ø‡≤´‡≥ç‡≤∞‡≥Ü‡≤∂‡≥ç',hbtn:'‡≤á‡≤§‡≤ø‡≤π‡≤æ‡≤∏'},
            bn: {title:'‡¶Æ‡¶ø‡¶ü‡ßç‡¶ü‡¶ø ‡¶Æ‡¶ø‡¶§‡ßç‡¶∞',sub:'‡¶ï‡ßÉ‡¶∑‡¶ø ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø',status:'‡¶∏‡¶Ç‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§',wtitle:'üå¶Ô∏è ‡¶Ü‡¶¨‡¶π‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ',stitle:'üìä ‡¶∏‡ßá‡¶®‡ßç‡¶∏‡¶∞',rtitle:'üí° ‡¶™‡¶∞‡¶æ‡¶Æ‡¶∞‡ßç‡¶∂',ph:'pH',moist:'‡¶Ü‡¶∞‡ßç‡¶¶‡ßç‡¶∞‡¶§‡¶æ',nitro:'‡¶®‡¶æ‡¶á‡¶ü‡ßç‡¶∞‡ßã‡¶ú‡ßá‡¶®',opt:'‡¶≠‡¶æ‡¶≤',low:'‡¶ï‡¶Æ',crit:'‡¶ú‡¶∞‡ßÅ‡¶∞‡¶ø',lval:'‡¶ï‡¶Æ',r1:'‡¶∏‡ßÄ‡¶Æ‡¶æ:',r2:'‡¶∏‡ßÄ‡¶Æ‡¶æ:',rbtn:'‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂',hbtn:'‡¶á‡¶§‡¶ø‡¶π‡¶æ‡¶∏'},
            gu: {title:'‡™Æ‡™ø‡™ü‡´ç‡™ü‡´Ä ‡™Æ‡™ø‡™§‡´ç‡™∞',sub:'‡™ñ‡´á‡™§‡´Ä ‡™Æ‡™¶‡™¶',status:'‡™ú‡´ã‡™°‡™æ‡™Ø‡´Å‡™Ç',wtitle:'üå¶Ô∏è ‡™π‡™µ‡™æ‡™Æ‡™æ‡™®',stitle:'üìä ‡™∏‡´á‡™®‡´ç‡™∏‡™∞',rtitle:'üí° ‡™∏‡™≤‡™æ‡™π',ph:'pH',moist:'‡™≠‡´á‡™ú',nitro:'‡™®‡™æ‡™à‡™ü‡´ç‡™∞‡´ã‡™ú‡™®',opt:'‡™∏‡™æ‡™∞‡´Å‡™Ç',low:'‡™ì‡™õ‡´Å‡™Ç',crit:'‡™ó‡™Ç‡™≠‡´Ä‡™∞',lval:'‡™ì‡™õ‡´Å‡™Ç',r1:'‡™∂‡´ç‡™∞‡´á‡™£‡´Ä:',r2:'‡™∂‡´ç‡™∞‡´á‡™£‡´Ä:',rbtn:'‡™∞‡™ø‡™´‡´ç‡™∞‡´á‡™∂',hbtn:'‡™á‡™§‡™ø‡™π‡™æ‡™∏'},
            pa: {title:'‡®Æ‡®ø‡©±‡®ü‡©Ä ‡®Æ‡®ø‡©±‡®§‡®∞',sub:'‡®ñ‡©á‡®§‡©Ä ‡®∏‡®π‡®æ‡®á‡®ï',status:'‡®ú‡©Å‡©ú‡®ø‡®Ü',wtitle:'üå¶Ô∏è ‡®Æ‡©å‡®∏‡®Æ',stitle:'üìä ‡®∏‡©à‡®Ç‡®∏‡®∞',rtitle:'üí° ‡®∏‡®≤‡®æ‡®π',ph:'pH',moist:'‡®®‡®Æ‡©Ä',nitro:'‡®®‡®æ‡®à‡®ü‡©ç‡®∞‡©ã‡®ú‡®®',opt:'‡®µ‡®ß‡©Ä‡®Ü',low:'‡®ò‡©±‡®ü',crit:'‡®ó‡©∞‡®≠‡©Ä‡®∞',lval:'‡®ò‡©±‡®ü',r1:'‡®∞‡©á‡®Ç‡®ú:',r2:'‡®∞‡©á‡®Ç‡®ú:',rbtn:'‡®§‡®æ‡®ú‡®º‡®æ',hbtn:'‡®á‡®§‡®ø‡®π‡®æ‡®∏'},
            ml: {title:'‡¥Æ‡¥ø‡¥ü‡µç‡¥ü‡¥ø ‡¥Æ‡¥ø‡¥§‡µç‡¥∞',sub:'‡¥ï‡µÉ‡¥∑‡¥ø ‡¥∏‡¥π‡¥æ‡¥Ø‡¥ø',status:'‡¥ï‡¥£‡¥ï‡µç‡¥±‡µç‡¥±‡¥°‡µç',wtitle:'üå¶Ô∏è ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥•',stitle:'üìä ‡¥∏‡µÜ‡µª‡¥∏‡µº',rtitle:'üí° ‡¥®‡¥ø‡µº‡¥¶‡µç‡¥¶‡µá‡¥∂‡¥Ç',ph:'pH',moist:'‡¥à‡µº‡¥™‡µç‡¥™‡¥Ç',nitro:'‡¥®‡µà‡¥ü‡µç‡¥∞‡¥ú‡µª',opt:'‡¥®‡¥≤‡µç‡¥≤‡¥§‡µç',low:'‡¥ï‡µÅ‡¥±‡¥µ‡µç',crit:'‡¥ó‡µÅ‡¥∞‡µÅ‡¥§‡¥∞‡¥Ç',lval:'‡¥ï‡µÅ‡¥±‡¥µ‡µç',r1:'‡¥™‡¥∞‡¥ø‡¥ß‡¥ø:',r2:'‡¥™‡¥∞‡¥ø‡¥ß‡¥ø:',rbtn:'‡¥±‡¥ø‡¥´‡µç‡¥∞‡¥∑‡µç',hbtn:'‡¥ö‡¥∞‡¥ø‡¥§‡µç‡¥∞‡¥Ç'},
            or: {title:'‡¨Æ‡¨ø‡¨ü‡¨ø ‡¨Æ‡¨ø‡¨§‡≠ç‡¨∞',sub:'‡¨ï‡≠É‡¨∑‡¨ø ‡¨∏‡¨π‡¨æ‡≠ü‡¨ï',status:'‡¨∏‡¨Ç‡¨Ø‡≠Å‡¨ï‡≠ç‡¨§',wtitle:'üå¶Ô∏è ‡¨™‡¨æ‡¨£‡¨ø‡¨™‡¨æ‡¨ó',stitle:'üìä ‡¨∏‡≠á‡¨®‡≠ç‡¨∏‡¨∞',rtitle:'üí° ‡¨™‡¨∞‡¨æ‡¨Æ‡¨∞‡≠ç‡¨∂',ph:'pH',moist:'‡¨Ü‡¨∞‡≠ç‡¨¶‡≠ç‡¨∞‡¨§‡¨æ',nitro:'‡¨®‡¨æ‡¨á‡¨ü‡≠ç‡¨∞‡≠ã‡¨ú‡≠á‡¨®',opt:'‡¨â‡¨§‡≠ç‡¨§‡¨Æ',low:'‡¨ï‡¨Æ‡≠ç',crit:'‡¨ó‡≠Å‡¨∞‡≠Å‡¨§‡¨∞',lval:'‡¨ï‡¨Æ‡≠ç',r1:'‡¨∏‡≠Ä‡¨Æ‡¨æ:',r2:'‡¨∏‡≠Ä‡¨Æ‡¨æ:',rbtn:'‡¨∞‡¨ø‡¨´‡≠ç‡¨∞‡≠á‡¨∂',hbtn:'‡¨á‡¨§‡¨ø‡¨π‡¨æ‡¨∏'}
        };

        async function getWeather(city) {
            try {
                const res = await fetch(`https://api.openweathermap.org/data/2.5/forecast?q=${city}&appid=${KEY}&units=metric`);
                if (!res.ok) throw new Error('Weather fetch failed');
                const d = await res.json();
                
                const forecasts = {};
                d.list.forEach(item => {
                    const date = new Date(item.dt * 1000).toLocaleDateString('en-US', {weekday: 'short', month: 'short', day: 'numeric'});
                    if (!forecasts[date]) {
                        forecasts[date] = {
                            date: date,
                            temps: [],
                            desc: item.weather[0].main,
                            hum: item.main.humidity,
                            wind: Math.round(item.wind.speed * 3.6)
                        };
                    }
                    forecasts[date].temps.push(Math.round(item.main.temp));
                });
                
                return {
                    name: d.city.name,
                    forecasts: Object.values(forecasts).slice(0, 7)
                };
            } catch(e) {
                console.error('Weather error:', e);
                return null;
            }
        }

        function nearby(c) {
            const map = {
                'Panchkula,IN': ['Panchkula,IN','Chandigarh,IN','Mohali,IN','Ambala,IN'],
                'Chandigarh,IN': ['Chandigarh,IN','Panchkula,IN','Mohali,IN'],
                'Mohali,IN': ['Mohali,IN','Chandigarh,IN','Panchkula,IN'],
                'Delhi,IN': ['Delhi,IN','Noida,IN','Gurugram,IN','Ghaziabad,IN'],
                'Mumbai,IN': ['Mumbai,IN','Pune,IN'],
                'Bangalore,IN': ['Bangalore,IN','Mysore,IN'],
                'Chennai,IN': ['Chennai,IN','Coimbatore,IN']
            };
            return map[c] || [c];
        }

        async function loadWeather() {
            const box = document.getElementById('weatherBox');
            const city = document.getElementById('regionSelect').value;
            box.innerHTML = '<div class="loading">Loading...</div>';
            
            const cities = nearby(city);
            const data = await Promise.all(cities.map(c => getWeather(c)));
            
            box.innerHTML = '';
            const validData = data.filter(d => d);
            
            if (validData.length === 0) {
                box.innerHTML = '<div class="loading">Weather data unavailable</div>';
                return;
            }
            
            validData.forEach(w => {
                box.innerHTML += `
                    <div class="weather-card glass">
                        <div class="weather-city">${w.name}</div>
                        <div class="weather-temp">${w.temp}¬∞C</div>
                        <div class="weather-condition">${w.desc}</div>
                        <div class="weather-details">
                            <div>üíß ${w.hum}%</div>
                            <div>üå¨Ô∏è ${w.wind}km/h</div>
                        </div>
                    </div>
                `;
            });
        }

        function changeLang() {
            const l = document.getElementById('langSelect').value;
            const t = lang[l];
            Object.keys(t).forEach(k => {
                const el = document.getElementById(k);
                if(el) el.textContent = t[k];
            });
        }

        function refresh() {
            loadWeather();
        }

        function showHistory() {
            alert('üìä Opening history...');
        }

        // Initialize event listeners
        document.getElementById('langSelect').addEventListener('change', changeLang);
        document.getElementById('regionSelect').addEventListener('change', loadWeather);

        // Load initial weather
        loadWeather();

        // Update time periodically
        setInterval(() => {
            const m = Math.floor(Math.random() * 5) + 1;
            document.getElementById('time').textContent = `${m} min ago`;
        }, 60000);
    </script>
</body>
</html>
